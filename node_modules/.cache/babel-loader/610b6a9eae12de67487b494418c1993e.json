{"ast":null,"code":"import _defineProperty from \"/home/danil/\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B/React/my-app-local/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport API from '../API/api.js';\nimport { updateObjectInArr } from './../Until/Object-helpers.js';\nimport { users_switchLoading, users_setUsers, users_setTotalCount, users_switchFollLoad, users_unFollow, users_follow, users_setFollows } from './dispatch-types.js';\nlet data = {\n  users: [],\n  pageSize: 2,\n  totalCount: 10,\n  currentPage: 1,\n  Loading: false,\n  FollowLoading: {\n    status: false,\n    id: null\n  }\n};\nexport const UsersReducer = (state = data, action) => {\n  switch (action.type) {\n    case 'FOLLOW':\n      {\n        return _objectSpread({}, state, {\n          users: updateObjectInArr(state.users, 'id', action.userId, {\n            followed: 'Follow'\n          })\n        });\n      }\n\n    case 'UNFOLLOW':\n      return _objectSpread({}, state, {\n        users: updateObjectInArr(state.users, 'id', action.userId, {\n          followed: 'UnFollow'\n        })\n      });\n\n    case 'SET-USERS':\n      return _objectSpread({}, state, {\n        users: [...action.users]\n      });\n\n    case 'SET-TOTAL-COUNT':\n      return _objectSpread({}, state, {\n        totalCount: action.totalCount\n      });\n\n    case 'SET-CURRENT-PAGE':\n      return _objectSpread({}, state, {\n        currentPage: action.currentPage\n      });\n\n    case 'SWITCH-LOADING':\n      {\n        return _objectSpread({}, state, {\n          isLoading: action.Loading\n        });\n      }\n\n    case 'SWITCH-FOLLOW-LOADING':\n      {\n        return _objectSpread({}, state, {\n          FollowLoading: action.FollowLoading\n        });\n      }\n  }\n\n  return state;\n};\nexport const reqUsers = (currentPage, pageSize, follows, isAuth) => async dispatch => {\n  dispatch(users_switchLoading(true));\n  let res = await new API().reqUsers(currentPage, pageSize);\n  let data = res.data;\n  debugger;\n  var length = data.users.length,\n      i = 0;\n\n  while (i < length) {\n    if (data.users[i] === null) {\n      data.users.splice(i, 1);\n      i = -1;\n    }\n\n    i++;\n  }\n\n  if (isAuth) {\n    for (var i = 0; i < data.users.length; i++) {\n      var isFollow = false;\n\n      for (var a = 0; a < follows.length; a++) {\n        if (data.users[i].id == follows[a]) {\n          data.users[i].followed = 'UnFollow';\n          var isFollow = true;\n        }\n      }\n\n      if (!isFollow) {\n        data.users[i].followed = 'Follow';\n      }\n    }\n  }\n\n  dispatch(users_setUsers(data.users));\n  dispatch(users_setTotalCount(data.totalCount));\n  dispatch(users_switchLoading(false));\n};\nexport const changeFollow = (text, authId, id) => async dispatch => {\n  dispatch(users_switchFollLoad(true, id));\n  text == 'Follow' ? dispatch(users_unFollow(id)) : dispatch(users_follow(id));\n  let res = await new API().changeFollow(authId, id, text);\n  dispatch(users_switchFollLoad(false, id));\n  document.cookie = \"follows=\" + res.data.follows + \"; path=/;\";\n  dispatch(users_setFollows(res.data.follows));\n};","map":{"version":3,"sources":["/home/danil/Рабочий стол/React/my-app-local/src/redux/users-reducer.js"],"names":["API","updateObjectInArr","users_switchLoading","users_setUsers","users_setTotalCount","users_switchFollLoad","users_unFollow","users_follow","users_setFollows","data","users","pageSize","totalCount","currentPage","Loading","FollowLoading","status","id","UsersReducer","state","action","type","userId","followed","isLoading","reqUsers","follows","isAuth","dispatch","res","length","i","splice","isFollow","a","changeFollow","text","authId","document","cookie"],"mappings":"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","sourcesContent":["import API from '../API/api.js';\nimport {updateObjectInArr} from './../Until/Object-helpers.js';\nimport {users_switchLoading,\n\t\tusers_setUsers,\n\t\tusers_setTotalCount,\n\t\tusers_switchFollLoad,\n\t\tusers_unFollow,\n\t\tusers_follow,\n\t\tusers_setFollows} from './dispatch-types.js';\n\nlet data = {\n\t\tusers: [],\n\t\tpageSize: 2,\n\t\ttotalCount: 10,\n\t\tcurrentPage: 1,\n\t\tLoading: false,\n\t\tFollowLoading: {\n\t\t\tstatus: false,\n\t\t\tid: null\n\t\t}\n}\n\nexport const UsersReducer = (state = data, action) => {\n\n\tswitch(action.type){\n\t\tcase 'FOLLOW': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\t users: updateObjectInArr(state.users, 'id', action.userId, {followed: 'Follow'})\n\t\t\t}\n\t\t}\n\t\tcase 'UNFOLLOW':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\t users: updateObjectInArr(state.users, 'id', action.userId, {followed: 'UnFollow'})\n\t\t\t}\n\t\tcase 'SET-USERS':\t\n\t\t\treturn {\n\t\t\t \t...state,\n\t\t\t \tusers: [...action.users]\n\t\t\t}\n\t\tcase 'SET-TOTAL-COUNT':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\ttotalCount: action.totalCount\t\n\t\t\t}\n\t\tcase 'SET-CURRENT-PAGE':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcurrentPage: action.currentPage\n\t\t}\n\t\tcase 'SWITCH-LOADING': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisLoading: action.Loading\n\t\t\t}\n\t\t}\n\t\tcase 'SWITCH-FOLLOW-LOADING': {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tFollowLoading: action.FollowLoading\n\t\t\t}\n\t\t}\n\t}\n\treturn state;\n}\n\n\nexport const reqUsers = (currentPage, pageSize, follows, isAuth) => async (dispatch) => {\n\tdispatch(users_switchLoading(true)); \n\tlet res = await new API().reqUsers(currentPage, pageSize);\n\tlet data = res.data;\n\tdebugger;\n\tvar length = data.users.length, i = 0;\n\twhile(i < length){\n\t\tif(data.users[i] === null){\n\t\t\tdata.users.splice(i, 1);\n\t\t\ti = -1;\n\t\t}\n\t\ti++;\n\t}\n\tif(isAuth){\n\t\tfor (var i = 0; i < data.users.length; i++) {\n\t\t\tvar isFollow = false;\n\t\t\tfor (var a = 0; a < follows.length; a++) {\n\t\t\t\tif(data.users[i].id == follows[a]){\n\t\t\t\t\tdata.users[i].followed = 'UnFollow';\n\t\t\t\t\tvar isFollow = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!isFollow){\n\t\t\t\tdata.users[i].followed = 'Follow';\n\t\t\t}\n\n\t\t}\t\t\t\n\t}\n\tdispatch(users_setUsers(data.users)); \n\tdispatch(users_setTotalCount(data.totalCount)); \n\tdispatch(users_switchLoading(false)); \n}\n\nexport const changeFollow = (text, authId, id) => async (dispatch) => {\n\n\tdispatch(users_switchFollLoad(true, id)); \n\n\ttext == 'Follow' ? dispatch(users_unFollow(id)) : dispatch(users_follow(id));\n\n\tlet res = await new API().changeFollow(authId, id, text);\n\n\tdispatch(users_switchFollLoad(false, id)); \n\n\tdocument.cookie = \"follows=\"+res.data.follows+\"; path=/;\";\n\n\tdispatch(users_setFollows(res.data.follows));\n}\n\n\n"]},"metadata":{},"sourceType":"module"}